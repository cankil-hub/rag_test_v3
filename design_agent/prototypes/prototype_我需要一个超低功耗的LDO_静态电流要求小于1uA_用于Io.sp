* Prototype: 该小信号等效电路表示采用Vadim Ivanov方法设计的超低功耗、任意负载稳定LDO。它包含一个误差放大器(EA)，一个PMOS调整管，以及一个电阻反馈网络。EA被建模为一个跨导放大器(VCCS)和输出电阻，驱动调整管的栅极。调整管被建模为一个VCCS和其自身输出电阻。电路包含内部补偿电容Cc，调整管栅极的寄生电容C_gb，以及输出负载电容CL和负载电阻RL。该架构旨在实现任意负载下的稳定性（包括无外部电容或仅片上电容）和快速瞬态响应。
* Requirement: 我需要一个超低功耗的LDO，静态电流要求小于1uA，用于IoT设备
* Generated by RAG-Guided Circuit Generator

.title 该小信号等效电路表示采用Vadim Ivanov方法设计的超低功耗、任意负载稳定LDO。它包含一个误差放大器(EA)，一个PMOS调整管，以及一个电阻反馈网络。EA被建模为一个跨导放大器(VCCS)和输出电阻，驱动调整管的栅极。调整管被建模为一个VCCS和其自身输出电阻。电路包含内部补偿电容Cc，调整管栅极的寄生电容C_gb，以及输出负载电容CL和负载电阻RL。该架构旨在实现任意负载下的稳定性（包括无外部电容或仅片上电容）和快速瞬态响应。

* Circuit parameters
.param gm_ea=5 uS
.param gm_pass=100 mS
.param ro_ea=10 MΩ
.param Cc=1 pF
.param CL=1 nF

* Input signal
VIN vin 0 DC 0.6 AC 1  * Reference/Input voltage

* Transconductance stages (VCCS)
Ggm_ea gate_pass gnd vref vfb 5uS  * 误差放大器(EA)的跨导，控制调整管栅极电压
Ggm_pass vout gnd vin gate_pass 100mS  * PMOS调整管的跨导，其电流 (gm_pass * (v_in - v_gate_pass)) 流向输出节点 vout

* Resistances
Rro_ea gate_pass gnd 10MΩ  * 误差放大器(EA)的输出电阻
Rro_pass vout vin 100kΩ  * PMOS调整管的输出电阻 (漏源电阻)
RRL vout gnd 1MΩ  * 负载电阻，表示轻负载条件下的等效阻抗
RRfb1 vout vfb 5MΩ  * 反馈分压电阻1
RRfb2 vfb gnd 5MΩ  * 反馈分压电阻2

* Capacitances
CC_gb gate_pass gnd 1pF  * 调整管栅极的寄生电容
CCc gate_pass vout 1pF  * 内部补偿电容，可能为米勒补偿或代表其他内部频率补偿效果
CCL vout gnd 1nF  * 片上负载电容 (典型值，范围100pF到几nF)

* AC Analysis
.ac dec 100 1 100Meg

.control
run
plot vdb(vout) phase(vout)
let gain_db = vdb(vout)
let phase_deg = phase(vout) * 180 / pi
meas ac ugf when gain_db=0
meas ac pm find phase_deg when gain_db=0
print ugf pm
.endc

.end